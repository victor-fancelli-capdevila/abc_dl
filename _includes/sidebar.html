<div class="sidebar">
  <!-- a little bit tricky: first we check for category, then we fill it-->
<nav>
  {% for category in site.data.docs-categories %}
    <ul>
      {% capture items %}
      {% for item in site.docs %}
        {% if category.title == item.category %}
        |{{ item.nav-order }}!{{ item.url }}#{{ item.title }}
        {% endif %}
      {% endfor %}
      {% endcapture %}
      {% assign sortedpages = items | split: '|' | sort %}
      {% for item in sortedpages %}
        {% assign postitems = item | split: '#' %}
        {% assign thisurl = postitems[0] | split: '!' %}
        {% if thisurl[1] == page.url %}
        <li class="active sidebar-first-level"><a href="{{site.baseurl}}{{ thisurl[1] }}">{{postitems [1]}}</a></li>
        <ul id="TOC"></ul>
        {% else %}
        <li class="sidebar-first-level"><a href="{{site.baseurl}}{{ thisurl[1] }}">{{postitems [1]}}</a></li>
        {% endif %}
      {% endfor %}
    </ul>
  {% endfor %}
</nav>
</div>
